EXECICIO 2:

Topologia A

	"ping" utilize ICMP protocolo para fazer ECHO_REQUEST, e esta a espera 
para receber datagrama ICMP ECHO_RESPONSE. Estas datagramas contém IP e ICMP 
cabeçalhos (header). Envia 64 ICMP data bytes do ICMP encapsulados em pacotes IP.
ICMP não garanta entrega dos pacotes e fiabilidade de transferência, pois não é
utilizado para envio e recepção dos dados entre estações finais.
	A nossa rede é construida em base da rede Ethernet. A rede Ethernet não
trabalha com endereços IP, e para identificar as maquinas que estou ligados nessa
rede utiliza MAC-addres (que é garantidamente único) do placa de rede de cada 
host em rede. Portanto para "traduzir" IP-adress em MAC utilizado protocolo ARP.
Antes de enviar ARP-request, stack da rede verifica se existe alguma informação
sobre receptor. Se não existir nenhuma informação no "cash" da ARP, feito 
"broadcast-request", que significa "algem sabe endereço fisico do dispositivo 
com seguinte IP-address??". Quem tiver o IP deve responder com ARP-reply, que 
significa "Sim este é o meu IP, o meu MAC é seguinte : ...". Podemos dizer que
ARP traduz endereços de camada de Rede para endereços de camada de Data Link. 
Portanto quando fazemos o primeira vez "ping" da maquina N4 para N2, gerado um
"broadcast-request". Depois a informação sobre este dispositivo fica guardado 
em "cash" da ARP. O tempo de vida do cash depende do fabricante.

***screen_A_1***

O exemplo representa os pacotes apanhados por wireshark na sequencia de 
execução do comando "ping 10.0.0.20 -c1" no pc com ip: 10.0.0.21. 
O primeiro pacote ARP enviado para os todos dispositivos da rede (broadcast)
como podemos verificar nos primeiros 6 bytes(FF:FF:FF:FF:FF:FF) que representa
endereço físico do destino. Os próximos 6 bytes representam endereço do origem.
Os próximos bytes 
0x0806 - indicam o tipo do protocolo ARP
0x0001 - tipo do hardware (Ethernet)
0x0800 - tipo do protocolo (IPv4)
0x06 - tamanho do endereço MAC (Hardware size)
0X04 - tamanho do endeço logico (Protocol size) 
0X01 - Opcode: request (1) pedido ARP

os últimos bytes representam IP e MAC endereços dos dispositivos.

***screen_A_2***

o pacote ICMP também vem incorporado dentro do pacote IPv4, como podemos 
verificar na imagem. Os primeiros 12 bytes representam endereços do 
destino e origem. os próximos 20 bytes é o cabeçalho do IPv4. 
Os próximos bytes representam o pacote ICMP :

0x08 - tipo (ping)
0x00 - code
0xa6f1 - somma de controlo (checksum)
0x0023 - identifier
0x001 - num sequencia 

os últimos 48 bytes preenchidos com valores aleatórios. 

HUB é um dispositivo do nível 1 do modelo OSI. Em modo geral representa um nó 
para juntar os HOST's em rede Ethernet usando cabos. HUB repete o sinal de
entrada para todos portes ligados, desta maneira HUB combina dispositivos 
em um único "domínio de colisão".

Consideramos Topologia A: N4 envia 3 ICMP pacotes para N2.(ping 10.0.0.10 -c3).
Como podemos verificar as outras maquinas em rede também recebem os pacotes 
ICMP que estão a circular na rede através do HUB.

***screen_A_3****

SWITCH dispositivo do nível 2 da camada OSI. Utilizado para comutar vários nós
da rede no limite dum ou vários segmentes da rede. SWITCH's foram desenvolvidos 
usando tecnologias de BRIDGE, portanto podem ser vistos como BRIDGE com múltiplos 
portes. Ao contrário do HUB que envia os dados para todos os dispositivos ligados, 
SWITCH transmite informação directamente ao destinatário. SWITCH guarda em memoria 
a tabela de comutação, onde cada MAC-address corresponde uma "porta" do SWITCH. 
Ao ligar dispositivo, a tabela  esta vazia, e o SWITCH está em modo "aprendizagem".
Neste modo os dados recebidos em qualquer "porta" enviados para todos dispositivos
ligados. Entretanto, SWITCH analisa os "frames", e depois de determinar MAC do host
emissor guarda em tabela (durante determinado tempo). Passado algum tempo o SWITCH 
construa a tabela com todos os MAC associados aos "portas". Desta maneira consegue 
localizar o tráfego.

***screen_B_1 && screen_B_2 ****

Consideramos Topologia B: N2 -> N1 (ping 10.0.0.10 -c3)
Podemos verificar que as outras maquinas que estão na rede, recebem só broadcast
ARP-request e não recebem outros pacotes.

*** screen_B_3*****


A Topologia C representa uma rede com 5 PC ,HUB e SWITCH. As maquinas n3, n4, n5
ligados através do HUB a SWITCH. AS maquinas n6, n7 estão ligados a SWITCH 
directamente. Ou seja, na tabele de endereços de SWITCH vai haver uma porta que 
corresponde aos 3 endereços físicos(MAC), e mais duas portas para endereços do n7
e n6. 

*** screen_C_1 ***




EXERCICIO 3:

DHCP (Dynamic Host Configuration Protocol), protocolo do nível 3(Rede), que permite
adquirir automaticamente IP endereço e outros paramentos, necessários para funcionar em rede TCP/IP. Este protocolo utiliza modelo "cliente - servidor".
Os endereços podem ser distribuídos manualmente, em regime automático (IP atribuído para sempre) e dinamicamente (IP atribuído para um determinado período).
Alem dos endereços IP, DHCP também pode fornecer ao cliente outras opções.
O DHCP utiliza a estrutura Cliente/Servidor, onde o cliente solicita o endereço e obtém a concessão de um IP, envolvendo quatro passos, que seguem a seguinte ordem: discover - offer - request - acknowledge.
Procura -> Proposta-> Pedido -> Confirmação.

Resumidamente, o DHCP opera da seguinte forma:
Um cliente envia um pacote UDP em broadcast (destinado a todas as máquinas) com uma requisição DHCP;
Os servidores DHCP que capturarem este pacote irão responder (se o cliente se enquadrar numa série de critérios) solicitante com um pacote com configurações onde constará, pelo menos, um endereço IP, uma máscara de rede e outros dados opcionais, como o gateway, servidores de DNS, etc...
O DHCP usa um modelo cliente-servidor, no qual o servidor DHCP mantém o controlo centralizado dos endereços IP usados na rede.


O primeiro passo para configurar um servidor DHCP é criar o arquivo de configuração que armazena as informações de rede para clientes. 
 Existem dois tipos de declarações no arquivo de configuração:
Parâmetros - determinam como executar uma tarefa, ou quais opções de configuração de rede enviar para o cliente.
Declarações - Descrever a topologia da rede, descrever os clientes, fornecer endereços para os clientes, ou aplicar um grupo de parâmetros a um grupo de declarações.
Estas opções controlam as opções de DHCP; enquanto os parâmetros configuram valores que não são opcionais ou controlam o modo como o servidor DHCP se comporta.

Em nosso caso configuração do Servidor fica em /etc/dhcp/dhcpd.conf

#
#   DHCP Server Config File
#
ddns-update-style none;
ignore client-updates;

lease-file-name "/var/lib/dhcpd/dhcpd.leases";
authoritative;

option domain-name                      "example.com";
default-lease-time                      86400;   # 24 hours
max-lease-time                          172800;  # 48 hours

subnet 192.168.1.0 netmask 255.255.255.0 {
        option routers                  192.168.1.1;
        option subnet-mask              255.255.255.0;
        option broadcast-address        192.168.1.255;
        option domain-name-servers      192.168.1.1;
        option ntp-servers              192.168.1.1;
        option netbios-name-servers     192.168.1.1;
        option netbios-node-type        8;
        range   192.168.1.101   192.168.1.200;
}


A nossa rede é 192.168.1.0/24. A declaração de sub-rede deve ser incluída para cada sub-rede na rede. Se não for, o servidor DHCP falha a iniciar.
Neste exemplo, há opções globais para cada cliente DHCP. Clientes recebem um endereço IP dentro do intervalo.

para identificar a sequencia de interacções entre cliente e servidor, desactivamos 
a opção DHCP-CLIENTE nos definições dum cliente em CORE. 
podemos verificar que IP não foi atribuído a esse computador-cliente. 

*** screen 2 semIp***

depois de activar dhcliet analisamos os pacotes capturados pelo servidor:

*** screen 4 pacSer **

Aqui claramente podemos observar os interacções entre Servidor e cliente..
Discover -> Offer-> Request-> ACK

Agora temos IP atribuído : 

*** screen 5 withIP ***

EXERCICIO 4 :

Conseguimos a juntar todas as topologia anteriores com os router's diferentes.
para configurar o router em modo de encaminhamento dinamico é necassario preinstalar Quagga.. depois nos Services->ativar os protocolos pretendidos e adicionar as redes ligados ao router. também é necessário definir o default route, para funcionamento correto dos router's. 

Cada rede implementada anteriormente deve estar ligada ao um router independente,
que devem estar ligados entre si com caminhos alternativos. 

Foi proposta a divisão da rede na gama de endereços 10.0.0.0/24. Como nos temos 4 
redes decidimos partir a esta gama em 4 sub-redes, 

******************************************************************
rede       *   mascara  *  Broadcast   *   Endr. validos         * 
******************************************************************
10.0.0.0   *     /26    *  10.0.0.63   *  10.0.0.1 - 10.0.0.62   *
10.0.0.64  *     /26    *  10.0.0.127  *  10.0.0.65 - 10.0.0.126 *
10.0.0.128 *     /26    *  10.0.0.191  *  10.0.0.126 - 10.0.0.191*
10.0.0.192 *     /26    *  10.0.0.255  *  10.0.0.193 - 10.0.0.254*
******************************************************************

Também pretendido que os vários routers estarão ligados entre si por uma sub-rede
com mascara /30 da uma rede 192.168.0.0/24.

********************************************************************
   rede       *   mascara  *  Broadcast   *   Endr. validos         * 
*********************************************************************
192.168.0.0  *     /30    *  192.168.0.3   *  192.168.0.1 - 192.168.0.2  
192.168.0.4  *     /30    *  192.168.0.7   *  192.168.0.5 - 192.168.0.6  
192.168.0.8  *     /30    *  192.168.0.11  *  192.168.0.9 - 192.168.0.10  
192.168.0.12 *     /30    *  192.168.0.15  *  192.168.0.13 - 192.168.0.14 
192.168.0.16 *     /30    *  192.168.0.19  *  192.168.0.17 - 192.168.0.18 
192.168.0.20 *     /30    *  192.168.0.23  *  192.168.0.21 - 192.168.0.22 
*********************************************************************

redes estarão divididas : 


Em seguida temos configurar encaminhamento dinâmico. Configurar encaminhamento dinâmico em CORE é fácil. O ponto mais importante é evitar os ciclos infinitos 
de encaminhamento.. Isto pode acontecer sé os routers estarão mal configurados, principalmente em "Default rout"


Depois configuramos os routes para modo de encaminhamento estático, que é implica
mais atenção, mas também conseguimos configurar a nossa maneira. 
para configurar o router em modo encaminhamento estático temos activar em Services-> static route. Dentro do ficheiro temos indicar todas as redes que pode interferir com o router , e a porta por qual a rede pode ser vista pelo router.. por exemplo a configuração pode ser seguinte 

/sbin/ip route add 10.0.0.0/26 via 192.168.0.1

Depois de configurar todos os routers na topologia a rede funciona bem.. 


** Imagem toplogia estática **









EXERCICIO 5 :

Um servidor web é um serviço de rede que envia conteúdo a um cliente através da web, que normalmente é as páginas da web, mas quaisquer outros documentos pode ser transferidos também. Servidores Web também são conhecidos como servidores HTTP, porque eles usam o protocolo de transporte de hipertexto (HTTP).

Neste trabalho para simular http-server utilizamos a fermenta "mini-httpd", e para simular FTP-SERVER usamos "vsftpd",

depois de inserir os dois servidores na rede anterior, começamos a testar o funcionamento deles.

*imagem ftp+http traceroute*

em HTTP cliente faz o pedido wget e recebe o ficheiro "index.html" que esta em servidor http. Os pacotes apanhados pelo cliente tambem podem ser claramente  vistas em Wireshark.

*imagem httpCliente ***   *Imagem pacotesCliente*



Para verificar o funcionamento do servidor FTP o cliente deve entrar em conecção com servidor com comando ftp.. Os resultado de iteração do cliente com servidor ftp e respectivos pacotes transferidos podem ser vistas nas imagens.. 


*ftp cliente *   *ftp ciente wireshark*



 





















